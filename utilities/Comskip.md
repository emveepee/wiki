# Comskip


Comskip is a third party commercial detection engine. The files it
creates can be used to easily skip commercials (adverts) watching
watching recordings.

<div class="vspace">

</div>

  - [History and Support](#toc1)
  - [Download](#toc2)
  - [Installation](#toc3)
  - [Upgrade Installations](#toc4)
  - [Auxiliary Comskip Tools](#toc5)
  - [Basic Settings](#toc6)
  - [Usage](#toc7)

</div>

<div class="vspace">

</div>

## <span id="toc1"></span> History and Support

Comskip was originally written by Jere\_Jones and Malore for Sage.
Further development is done by Erik to make Comskip also usable under a
broader set of conditions. A support forum can be found at
[kaashoek.com/comskip](http://www.kaashoek.com/comskip).

Comskip is a standalone program that processes video files and generates
text files which list the start and end frames of detected commercials.
The commercial detection program is open source. It uses libmpeg2 to
read the mpeg2 files and commercial detection was added by rewriting and
tweaking some of the commercial detection code from MythTV. Current
commercial detection algorithms include black frame detection, logo
detect, aspect ratio changes, scene change rate, closed captioning and
many more. The newer versions by Erik include sound processing using
libavcodec. Support for h.264/AAC and WTV is available (donators version
only).

The commercial break .txt files are generated by running the Comskip.exe
file on the desired mpeg files. NextPVR also requires an .edl file (see
below). Many other output formats for mpeg editors are possible, the
included ini file lists the possible output options.


## <span id="toc2"></span> Download

Download the Comskip zip file from
[kaashoek.com/files](http://www.kaashoek.com/files/) (look for the most
recent version) .

## <span id="toc3"></span> Installation

Extract these files from the zip into a directory of your choice. Some users install in "C:\\comskip\\" (recommended), etc., but others have suggested installing in the \\Scripts directory under the [Default Data Directory](QuickStart.InstalledParts#datadirectory).

  - comskip.exe
  - comskip.ini

## <span id="toc4"></span> Upgrade Installations

If you have already configured a comskip.ini to your liking, do NOT copy
the new comskip.ini to the comskip directory, as you will overwrite
those settings. However sometimes the developer adds new parameters to
the comskip.ini. so you can either look at the recent changes in the
readme.txt, and add those lines manually to your comskip.ini, or save
your old comskip.ini as (e.g.) comskip.old.txt, THEN extract the new
comskip.ini to the comskip directory and adjust the particular settings
from YOUR comskip.old.txt to the updated comskip.ini from the new
release. It is also recommended that you look at the "modified" dates of
the files in the ZIP file and extract any other updated files.

## <span id="toc5"></span> Auxiliary Comskip Tools

Use ComskipGUI.exe to see what Comskip is doing when processing a file.

  - Drag and drop the file to be processed on ComskipGUI.exe

HideRun.exe can be used to run Comskip without showing the console
window.

  - Usage: HideRun "path\\to\\comskip.exe" "parameters for comskip".
  - Hiderun requires .net to be installed

## <span id="toc6"></span> Basic Settings

Change these settings in the .ini file:
```
output_edl=3
;NextPVR uses the edl file option
live_tv=1
;needed for live TV and parallel processing
edl_skip_field=3
;show commercial breaks in the time line

```
  - You may also want to see which methods that work best for you
  - There are plenty of comments in the ComSkip.ini file.

For a complete list of ini settings please visit <http://www.kaashoek.com/comskip/viewtopic.php?f=2&t=474> The tuning in the default .ini may work well for you, but tuning infomation is also available in the Tuning.htm file included in the .zip, and at the [Comskip Support Forum](http://www.kaashoek.com/comskip).

## <span id="toc7"></span> Usage

NextPVR defaults to Auto Skipping. To disable the Auto Skipping of commercials on a one time only basis hit 999. To disable Auto Skipping altogether, set \<AutoSkip\>false\</AutoSkip\> in NextPVR's Config.xml file. To skip manually, just press the play button (ctrl p) during a commercial. It will move you to the next break. The OSD will show you a green time line with dark sections where there is a commercial marked.

To run Comskip create a **ParallelProcessing.bat** file in [Default Data Directory]()/scripts folder.

This file, when found, is automatically run by NextPVR when it begins a recording. NextPVR wil pass \<filename\> <channelnumber\> \<oid\> as input parameters to the .bat file when it is run.

A very simple Windows ParallelProcessing.bat file:

```
@echo off
comskip %1
```

Using a fully qualified path to change to the comskip subdir is necessary for comskip to reliably find it's .ini file. the quotes are always a safe measure for strings with spaces or long filenames.

Parallel processing can tax your CPU, so a dual-core CPU (minimally) is recommended. Running comskip in parallel is preferred, however, some h.264 recordings may fail parallel processing.

Alternatively you can start Comskip when a recording ends by creating a **PostProcessing.bat** file in "[Default Data Directory](QuickStart.InstalledParts#datadirectory)\\Scripts". You may wish to do this if you transcode your recordings first, if your h.264 recordings fail to comskip in parallel, or if you lack adequate processing power to run in parallel. If you transcode, set the comskip .ini settings to support your alternative file format.

Category:[Utilities](Utilities)
